# Temperature
Temperature readings of various kinds in various places.\
Lets's create the Oracle tables.
```
  CREATE TABLE "LOCATION" 
   (	"LOC_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"NAME" VARCHAR2(30 CHAR) NOT NULL ENABLE, 
	 CONSTRAINT "LOCATION_PK" PRIMARY KEY ("LOC_ID")
  USING INDEX  ENABLE
   ) ;

  CREATE TABLE "TEMP_TYPE" 
   (	"TET_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"DESCRIPTION" VARCHAR2(30 CHAR) NOT NULL ENABLE, 
	 CONSTRAINT "TEMP_TYPE_PK" PRIMARY KEY ("TET_ID")
  USING INDEX  ENABLE
   ) ;

  CREATE TABLE "TEMPERATURE" 
   (	"MOMENT" DATE NOT NULL ENABLE, 
	"LOC_ID" NUMBER NOT NULL ENABLE, 
	"TET_ID" NUMBER NOT NULL ENABLE, 
	"MEASUREMENT" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "TEMPERATURE_CON" PRIMARY KEY ("MOMENT", "LOC_ID", "TET_ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "TEMPERATURE" ADD CONSTRAINT "TEMPERATURE_FK1" FOREIGN KEY ("LOC_ID")
	  REFERENCES "LOCATION" ("LOC_ID") ENABLE;
  ALTER TABLE "TEMPERATURE" ADD CONSTRAINT "TEMPERATURE_FK2" FOREIGN KEY ("TET_ID")
	  REFERENCES "TEMP_TYPE" ("TET_ID") ENABLE;

CREATE OR REPLACE FORCE EDITIONABLE VIEW  "LATEST_TEMPERATURE" ("LOC_ID", "TET_ID", "MEASUREMENT", "MOMENT", "RECENT") AS 
  SELECT L.name, Y.description, T.MEASUREMENT, T.MOMENT, CASE WHEN (SYSDATE - T.moment) * 24 * 60 < 15 THEN 'Y' ELSE 'N' END as recent
FROM (
    SELECT LOC_ID, TET_ID, MEASUREMENT, MOMENT,
           RANK() OVER (PARTITION BY LOC_ID, TET_ID ORDER BY MOMENT DESC) AS rnk
    FROM TEMPERATURE
) T
, location L
, temp_type Y
where T.loc_id=L.loc_id
  and T.tet_id=Y.tet_id
  and T.rnk = 1
/
```
